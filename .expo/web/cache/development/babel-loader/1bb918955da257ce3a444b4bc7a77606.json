{"ast":null,"code":"\"use strict\";\n\nvar _extends = require(\"@babel/runtime/helpers/extends\");\n\nvar _jsxFileName = \"C:\\\\distribuidas\\\\apps\\\\sarasapp\\\\node_modules\\\\react-native-image-pan-zoom\\\\built\\\\image-zoom\\\\image-zoom.component.js\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar react_native_1 = require(\"react-native-web/dist/index\");\n\nvar image_zoom_style_1 = require(\"./image-zoom.style\");\n\nvar image_zoom_type_1 = require(\"./image-zoom.type\");\n\nvar ImageViewer = function (_super) {\n  __extends(ImageViewer, _super);\n\n  function ImageViewer() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = new image_zoom_type_1.ImageZoomState();\n    _this.lastPositionX = null;\n    _this.positionX = 0;\n    _this.animatedPositionX = new react_native_1.Animated.Value(0);\n    _this.lastPositionY = null;\n    _this.positionY = 0;\n    _this.animatedPositionY = new react_native_1.Animated.Value(0);\n    _this.scale = 1;\n    _this.animatedScale = new react_native_1.Animated.Value(1);\n    _this.zoomLastDistance = null;\n    _this.zoomCurrentDistance = 0;\n    _this.lastTouchStartTime = 0;\n    _this.horizontalWholeOuterCounter = 0;\n    _this.swipeDownOffset = 0;\n    _this.horizontalWholeCounter = 0;\n    _this.verticalWholeCounter = 0;\n    _this.centerDiffX = 0;\n    _this.centerDiffY = 0;\n    _this.lastClickTime = 0;\n    _this.doubleClickX = 0;\n    _this.doubleClickY = 0;\n    _this.isDoubleClick = false;\n    _this.isLongPress = false;\n    _this.isHorizontalWrap = false;\n    _this.imagePanResponder = react_native_1.PanResponder.create({\n      onStartShouldSetPanResponder: _this.props.onStartShouldSetPanResponder,\n      onPanResponderTerminationRequest: _this.props.onPanResponderTerminationRequest,\n      onMoveShouldSetPanResponder: _this.props.onMoveShouldSetPanResponder,\n      onPanResponderGrant: function onPanResponderGrant(evt) {\n        _this.lastPositionX = null;\n        _this.lastPositionY = null;\n        _this.zoomLastDistance = null;\n        _this.horizontalWholeCounter = 0;\n        _this.verticalWholeCounter = 0;\n        _this.lastTouchStartTime = new Date().getTime();\n        _this.isDoubleClick = false;\n        _this.isLongPress = false;\n        _this.isHorizontalWrap = false;\n\n        if (_this.singleClickTimeout) {\n          clearTimeout(_this.singleClickTimeout);\n        }\n\n        if (evt.nativeEvent.changedTouches.length > 1) {\n          var centerX = (evt.nativeEvent.changedTouches[0].pageX + evt.nativeEvent.changedTouches[1].pageX) / 2;\n          _this.centerDiffX = centerX - _this.props.cropWidth / 2;\n          var centerY = (evt.nativeEvent.changedTouches[0].pageY + evt.nativeEvent.changedTouches[1].pageY) / 2;\n          _this.centerDiffY = centerY - _this.props.cropHeight / 2;\n        }\n\n        if (_this.longPressTimeout) {\n          clearTimeout(_this.longPressTimeout);\n        }\n\n        var _a = evt.nativeEvent,\n            locationX = _a.locationX,\n            locationY = _a.locationY,\n            pageX = _a.pageX,\n            pageY = _a.pageY;\n        _this.longPressTimeout = setTimeout(function () {\n          _this.isLongPress = true;\n\n          if (_this.props.onLongPress) {\n            _this.props.onLongPress({\n              locationX: locationX,\n              locationY: locationY,\n              pageX: pageX,\n              pageY: pageY\n            });\n          }\n        }, _this.props.longPressTime);\n\n        if (evt.nativeEvent.changedTouches.length <= 1) {\n          if (new Date().getTime() - _this.lastClickTime < (_this.props.doubleClickInterval || 0)) {\n            _this.lastClickTime = 0;\n            _this.doubleClickX = evt.nativeEvent.changedTouches[0].pageX;\n            _this.doubleClickY = evt.nativeEvent.changedTouches[0].pageY;\n\n            if (_this.props.onDoubleClick) {\n              _this.props.onDoubleClick({\n                locationX: evt.nativeEvent.changedTouches[0].locationX,\n                locationY: evt.nativeEvent.changedTouches[0].locationY,\n                pageX: _this.doubleClickX,\n                pageY: _this.doubleClickY\n              });\n            }\n\n            clearTimeout(_this.longPressTimeout);\n            _this.isDoubleClick = true;\n\n            if (_this.props.enableDoubleClickZoom) {\n              if (_this.scale > 1 || _this.scale < 1) {\n                _this.scale = 1;\n                _this.positionX = 0;\n                _this.positionY = 0;\n              } else {\n                var beforeScale = _this.scale;\n                _this.scale = 2;\n                var diffScale = _this.scale - beforeScale;\n                _this.positionX = (_this.props.cropWidth / 2 - _this.doubleClickX) * diffScale / _this.scale;\n                _this.positionY = (_this.props.cropHeight / 2 - _this.doubleClickY) * diffScale / _this.scale;\n              }\n\n              _this.imageDidMove('centerOn');\n\n              react_native_1.Animated.parallel([react_native_1.Animated.timing(_this.animatedScale, {\n                toValue: _this.scale,\n                duration: 100,\n                useNativeDriver: !!_this.props.useNativeDriver\n              }), react_native_1.Animated.timing(_this.animatedPositionX, {\n                toValue: _this.positionX,\n                duration: 100,\n                useNativeDriver: !!_this.props.useNativeDriver\n              }), react_native_1.Animated.timing(_this.animatedPositionY, {\n                toValue: _this.positionY,\n                duration: 100,\n                useNativeDriver: !!_this.props.useNativeDriver\n              })]).start();\n            }\n          } else {\n            _this.lastClickTime = new Date().getTime();\n          }\n        }\n      },\n      onPanResponderMove: function onPanResponderMove(evt, gestureState) {\n        if (_this.isDoubleClick) {\n          return;\n        }\n\n        if (evt.nativeEvent.changedTouches.length <= 1) {\n          var diffX = gestureState.dx - (_this.lastPositionX || 0);\n\n          if (_this.lastPositionX === null) {\n            diffX = 0;\n          }\n\n          var diffY = gestureState.dy - (_this.lastPositionY || 0);\n\n          if (_this.lastPositionY === null) {\n            diffY = 0;\n          }\n\n          _this.lastPositionX = gestureState.dx;\n          _this.lastPositionY = gestureState.dy;\n          _this.horizontalWholeCounter += diffX;\n          _this.verticalWholeCounter += diffY;\n\n          if (Math.abs(_this.horizontalWholeCounter) > 5 || Math.abs(_this.verticalWholeCounter) > 5) {\n            clearTimeout(_this.longPressTimeout);\n          }\n\n          if (_this.props.panToMove) {\n            if (_this.swipeDownOffset === 0) {\n              if (Math.abs(diffX) > Math.abs(diffY)) {\n                _this.isHorizontalWrap = true;\n              }\n\n              if (_this.props.imageWidth * _this.scale > _this.props.cropWidth) {\n                if (_this.horizontalWholeOuterCounter > 0) {\n                  if (diffX < 0) {\n                    if (_this.horizontalWholeOuterCounter > Math.abs(diffX)) {\n                      _this.horizontalWholeOuterCounter += diffX;\n                      diffX = 0;\n                    } else {\n                      diffX += _this.horizontalWholeOuterCounter;\n                      _this.horizontalWholeOuterCounter = 0;\n\n                      if (_this.props.horizontalOuterRangeOffset) {\n                        _this.props.horizontalOuterRangeOffset(0);\n                      }\n                    }\n                  } else {\n                    _this.horizontalWholeOuterCounter += diffX;\n                  }\n                } else if (_this.horizontalWholeOuterCounter < 0) {\n                  if (diffX > 0) {\n                    if (Math.abs(_this.horizontalWholeOuterCounter) > diffX) {\n                      _this.horizontalWholeOuterCounter += diffX;\n                      diffX = 0;\n                    } else {\n                      diffX += _this.horizontalWholeOuterCounter;\n                      _this.horizontalWholeOuterCounter = 0;\n\n                      if (_this.props.horizontalOuterRangeOffset) {\n                        _this.props.horizontalOuterRangeOffset(0);\n                      }\n                    }\n                  } else {\n                    _this.horizontalWholeOuterCounter += diffX;\n                  }\n                } else {}\n\n                _this.positionX += diffX / _this.scale;\n                var horizontalMax = (_this.props.imageWidth * _this.scale - _this.props.cropWidth) / 2 / _this.scale;\n\n                if (_this.positionX < -horizontalMax) {\n                  _this.positionX = -horizontalMax;\n                  _this.horizontalWholeOuterCounter += -1 / 1e10;\n                } else if (_this.positionX > horizontalMax) {\n                  _this.positionX = horizontalMax;\n                  _this.horizontalWholeOuterCounter += 1 / 1e10;\n                }\n\n                _this.animatedPositionX.setValue(_this.positionX);\n              } else {\n                _this.horizontalWholeOuterCounter += diffX;\n              }\n\n              if (_this.horizontalWholeOuterCounter > (_this.props.maxOverflow || 0)) {\n                _this.horizontalWholeOuterCounter = _this.props.maxOverflow || 0;\n              } else if (_this.horizontalWholeOuterCounter < -(_this.props.maxOverflow || 0)) {\n                _this.horizontalWholeOuterCounter = -(_this.props.maxOverflow || 0);\n              }\n\n              if (_this.horizontalWholeOuterCounter !== 0) {\n                if (_this.props.horizontalOuterRangeOffset) {\n                  _this.props.horizontalOuterRangeOffset(_this.horizontalWholeOuterCounter);\n                }\n              }\n            }\n\n            if (_this.props.imageHeight * _this.scale > _this.props.cropHeight) {\n              _this.positionY += diffY / _this.scale;\n\n              _this.animatedPositionY.setValue(_this.positionY);\n            } else {\n              if (_this.props.enableSwipeDown && !_this.isHorizontalWrap) {\n                _this.swipeDownOffset += diffY;\n\n                if (_this.swipeDownOffset > 0) {\n                  _this.positionY += diffY / _this.scale;\n\n                  _this.animatedPositionY.setValue(_this.positionY);\n\n                  _this.scale = _this.scale - diffY / 1000;\n\n                  _this.animatedScale.setValue(_this.scale);\n                }\n              }\n            }\n          }\n        } else {\n          if (_this.longPressTimeout) {\n            clearTimeout(_this.longPressTimeout);\n          }\n\n          if (_this.props.pinchToZoom) {\n            var minX = void 0;\n            var maxX = void 0;\n\n            if (evt.nativeEvent.changedTouches[0].locationX > evt.nativeEvent.changedTouches[1].locationX) {\n              minX = evt.nativeEvent.changedTouches[1].pageX;\n              maxX = evt.nativeEvent.changedTouches[0].pageX;\n            } else {\n              minX = evt.nativeEvent.changedTouches[0].pageX;\n              maxX = evt.nativeEvent.changedTouches[1].pageX;\n            }\n\n            var minY = void 0;\n            var maxY = void 0;\n\n            if (evt.nativeEvent.changedTouches[0].locationY > evt.nativeEvent.changedTouches[1].locationY) {\n              minY = evt.nativeEvent.changedTouches[1].pageY;\n              maxY = evt.nativeEvent.changedTouches[0].pageY;\n            } else {\n              minY = evt.nativeEvent.changedTouches[0].pageY;\n              maxY = evt.nativeEvent.changedTouches[1].pageY;\n            }\n\n            var widthDistance = maxX - minX;\n            var heightDistance = maxY - minY;\n            var diagonalDistance = Math.sqrt(widthDistance * widthDistance + heightDistance * heightDistance);\n            _this.zoomCurrentDistance = Number(diagonalDistance.toFixed(1));\n\n            if (_this.zoomLastDistance !== null) {\n              var distanceDiff = (_this.zoomCurrentDistance - _this.zoomLastDistance) / 200;\n              var zoom = _this.scale + distanceDiff;\n\n              if (zoom < (_this.props.minScale || 0)) {\n                zoom = _this.props.minScale || 0;\n              }\n\n              if (zoom > (_this.props.maxScale || 0)) {\n                zoom = _this.props.maxScale || 0;\n              }\n\n              var beforeScale = _this.scale;\n              _this.scale = zoom;\n\n              _this.animatedScale.setValue(_this.scale);\n\n              var diffScale = _this.scale - beforeScale;\n              _this.positionX -= _this.centerDiffX * diffScale / _this.scale;\n              _this.positionY -= _this.centerDiffY * diffScale / _this.scale;\n\n              _this.animatedPositionX.setValue(_this.positionX);\n\n              _this.animatedPositionY.setValue(_this.positionY);\n            }\n\n            _this.zoomLastDistance = _this.zoomCurrentDistance;\n          }\n        }\n\n        _this.imageDidMove('onPanResponderMove');\n      },\n      onPanResponderRelease: function onPanResponderRelease(evt, gestureState) {\n        if (_this.longPressTimeout) {\n          clearTimeout(_this.longPressTimeout);\n        }\n\n        if (_this.isDoubleClick) {\n          return;\n        }\n\n        if (_this.isLongPress) {\n          return;\n        }\n\n        var moveDistance = Math.sqrt(gestureState.dx * gestureState.dx + gestureState.dy * gestureState.dy);\n        var _a = evt.nativeEvent,\n            locationX = _a.locationX,\n            locationY = _a.locationY,\n            pageX = _a.pageX,\n            pageY = _a.pageY;\n\n        if (evt.nativeEvent.changedTouches.length === 1 && moveDistance < (_this.props.clickDistance || 0)) {\n          _this.singleClickTimeout = setTimeout(function () {\n            if (_this.props.onClick) {\n              _this.props.onClick({\n                locationX: locationX,\n                locationY: locationY,\n                pageX: pageX,\n                pageY: pageY\n              });\n            }\n          }, _this.props.doubleClickInterval);\n        } else {\n          if (_this.props.responderRelease) {\n            _this.props.responderRelease(gestureState.vx, _this.scale);\n          }\n\n          _this.panResponderReleaseResolve();\n        }\n      },\n      onPanResponderTerminate: function onPanResponderTerminate() {}\n    });\n\n    _this.resetScale = function () {\n      _this.positionX = 0;\n      _this.positionY = 0;\n      _this.scale = 1;\n\n      _this.animatedScale.setValue(1);\n    };\n\n    _this.panResponderReleaseResolve = function () {\n      if (_this.props.enableSwipeDown && _this.props.swipeDownThreshold) {\n        if (_this.swipeDownOffset > _this.props.swipeDownThreshold) {\n          if (_this.props.onSwipeDown) {\n            _this.props.onSwipeDown();\n          }\n\n          return;\n        }\n      }\n\n      if (_this.props.enableCenterFocus && _this.scale < 1) {\n        _this.scale = 1;\n        react_native_1.Animated.timing(_this.animatedScale, {\n          toValue: _this.scale,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      if (_this.props.imageWidth * _this.scale <= _this.props.cropWidth) {\n        _this.positionX = 0;\n        react_native_1.Animated.timing(_this.animatedPositionX, {\n          toValue: _this.positionX,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      if (_this.props.imageHeight * _this.scale <= _this.props.cropHeight) {\n        _this.positionY = 0;\n        react_native_1.Animated.timing(_this.animatedPositionY, {\n          toValue: _this.positionY,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      if (_this.props.imageHeight * _this.scale > _this.props.cropHeight) {\n        var verticalMax = (_this.props.imageHeight * _this.scale - _this.props.cropHeight) / 2 / _this.scale;\n\n        if (_this.positionY < -verticalMax) {\n          _this.positionY = -verticalMax;\n        } else if (_this.positionY > verticalMax) {\n          _this.positionY = verticalMax;\n        }\n\n        react_native_1.Animated.timing(_this.animatedPositionY, {\n          toValue: _this.positionY,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      if (_this.props.imageWidth * _this.scale > _this.props.cropWidth) {\n        var horizontalMax = (_this.props.imageWidth * _this.scale - _this.props.cropWidth) / 2 / _this.scale;\n\n        if (_this.positionX < -horizontalMax) {\n          _this.positionX = -horizontalMax;\n        } else if (_this.positionX > horizontalMax) {\n          _this.positionX = horizontalMax;\n        }\n\n        react_native_1.Animated.timing(_this.animatedPositionX, {\n          toValue: _this.positionX,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      if (_this.props.enableCenterFocus && _this.scale === 1) {\n        _this.positionX = 0;\n        _this.positionY = 0;\n        react_native_1.Animated.timing(_this.animatedPositionX, {\n          toValue: _this.positionX,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n        react_native_1.Animated.timing(_this.animatedPositionY, {\n          toValue: _this.positionY,\n          duration: 100,\n          useNativeDriver: !!_this.props.useNativeDriver\n        }).start();\n      }\n\n      _this.horizontalWholeOuterCounter = 0;\n      _this.swipeDownOffset = 0;\n\n      _this.imageDidMove('onPanResponderRelease');\n    };\n\n    return _this;\n  }\n\n  ImageViewer.prototype.componentDidMount = function () {\n    if (this.props.centerOn) {\n      this.centerOn(this.props.centerOn);\n    }\n  };\n\n  ImageViewer.prototype.componentDidUpdate = function (prevProps) {\n    if (this.props.centerOn && !prevProps.centerOn || this.props.centerOn && prevProps.centerOn && this.didCenterOnChange(prevProps.centerOn, this.props.centerOn)) {\n      this.centerOn(this.props.centerOn);\n    }\n  };\n\n  ImageViewer.prototype.imageDidMove = function (type) {\n    if (this.props.onMove) {\n      this.props.onMove({\n        type: type,\n        positionX: this.positionX,\n        positionY: this.positionY,\n        scale: this.scale,\n        zoomCurrentDistance: this.zoomCurrentDistance\n      });\n    }\n  };\n\n  ImageViewer.prototype.didCenterOnChange = function (params, paramsNext) {\n    return params.x !== paramsNext.x || params.y !== paramsNext.y || params.scale !== paramsNext.scale;\n  };\n\n  ImageViewer.prototype.centerOn = function (params) {\n    var _this = this;\n\n    this.positionX = params.x;\n    this.positionY = params.y;\n    this.scale = params.scale;\n    var duration = params.duration || 300;\n    react_native_1.Animated.parallel([react_native_1.Animated.timing(this.animatedScale, {\n      toValue: this.scale,\n      duration: duration,\n      useNativeDriver: !!this.props.useNativeDriver\n    }), react_native_1.Animated.timing(this.animatedPositionX, {\n      toValue: this.positionX,\n      duration: duration,\n      useNativeDriver: !!this.props.useNativeDriver\n    }), react_native_1.Animated.timing(this.animatedPositionY, {\n      toValue: this.positionY,\n      duration: duration,\n      useNativeDriver: !!this.props.useNativeDriver\n    })]).start(function () {\n      _this.imageDidMove('centerOn');\n    });\n  };\n\n  ImageViewer.prototype.handleLayout = function (event) {\n    if (this.props.layoutChange) {\n      this.props.layoutChange(event);\n    }\n  };\n\n  ImageViewer.prototype.reset = function () {\n    this.scale = 1;\n    this.animatedScale.setValue(this.scale);\n    this.positionX = 0;\n    this.animatedPositionX.setValue(this.positionX);\n    this.positionY = 0;\n    this.animatedPositionY.setValue(this.positionY);\n  };\n\n  ImageViewer.prototype.render = function () {\n    var animateConf = {\n      transform: [{\n        scale: this.animatedScale\n      }, {\n        translateX: this.animatedPositionX\n      }, {\n        translateY: this.animatedPositionY\n      }]\n    };\n    var parentStyles = react_native_1.StyleSheet.flatten(this.props.style);\n    return React.createElement(react_native_1.View, _extends({\n      style: __assign(__assign(__assign({}, image_zoom_style_1.default.container), parentStyles), {\n        width: this.props.cropWidth,\n        height: this.props.cropHeight\n      })\n    }, this.imagePanResponder.panHandlers, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 619,\n        columnNumber: 17\n      }\n    }), React.createElement(react_native_1.Animated.View, {\n      style: animateConf,\n      renderToHardwareTextureAndroid: this.props.useHardwareTextureAndroid,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 620,\n        columnNumber: 9\n      }\n    }, React.createElement(react_native_1.View, {\n      onLayout: this.handleLayout.bind(this),\n      style: {\n        width: this.props.imageWidth,\n        height: this.props.imageHeight\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 621,\n        columnNumber: 11\n      }\n    }, this.props.children)));\n  };\n\n  ImageViewer.defaultProps = new image_zoom_type_1.ImageZoomProps();\n  return ImageViewer;\n}(React.Component);\n\nexports.default = ImageViewer;","map":{"version":3,"sources":["../../src/image-zoom/image-zoom.component.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_native_1 = require(\"react-native\");\nvar image_zoom_style_1 = require(\"./image-zoom.style\");\nvar image_zoom_type_1 = require(\"./image-zoom.type\");\nvar ImageViewer = /** @class */ (function (_super) {\n    __extends(ImageViewer, _super);\n    function ImageViewer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = new image_zoom_type_1.ImageZoomState();\n        // 上次/当前/动画 x 位移\n        _this.lastPositionX = null;\n        _this.positionX = 0;\n        _this.animatedPositionX = new react_native_1.Animated.Value(0);\n        // 上次/当前/动画 y 位移\n        _this.lastPositionY = null;\n        _this.positionY = 0;\n        _this.animatedPositionY = new react_native_1.Animated.Value(0);\n        // 缩放大小\n        _this.scale = 1;\n        _this.animatedScale = new react_native_1.Animated.Value(1);\n        _this.zoomLastDistance = null;\n        _this.zoomCurrentDistance = 0;\n        // 上次手按下去的时间\n        _this.lastTouchStartTime = 0;\n        // 滑动过程中，整体横向过界偏移量\n        _this.horizontalWholeOuterCounter = 0;\n        // 滑动过程中，swipeDown 偏移量\n        _this.swipeDownOffset = 0;\n        // 滑动过程中，x y的总位移\n        _this.horizontalWholeCounter = 0;\n        _this.verticalWholeCounter = 0;\n        // 两手距离中心点位置\n        _this.centerDiffX = 0;\n        _this.centerDiffY = 0;\n        // 上一次点击的时间\n        _this.lastClickTime = 0;\n        // 双击时的位置\n        _this.doubleClickX = 0;\n        _this.doubleClickY = 0;\n        // 是否双击了\n        _this.isDoubleClick = false;\n        // 是否是长按\n        _this.isLongPress = false;\n        // 是否在左右滑\n        _this.isHorizontalWrap = false;\n        // 图片手势处理\n        _this.imagePanResponder = react_native_1.PanResponder.create({\n            // 要求成为响应者：\n            onStartShouldSetPanResponder: _this.props.onStartShouldSetPanResponder,\n            onPanResponderTerminationRequest: _this.props.onPanResponderTerminationRequest,\n            onMoveShouldSetPanResponder: _this.props.onMoveShouldSetPanResponder,\n            onPanResponderGrant: function (evt) {\n                // 开始手势操作\n                _this.lastPositionX = null;\n                _this.lastPositionY = null;\n                _this.zoomLastDistance = null;\n                _this.horizontalWholeCounter = 0;\n                _this.verticalWholeCounter = 0;\n                _this.lastTouchStartTime = new Date().getTime();\n                _this.isDoubleClick = false;\n                _this.isLongPress = false;\n                _this.isHorizontalWrap = false;\n                // 任何手势开始，都清空单击计时器\n                if (_this.singleClickTimeout) {\n                    clearTimeout(_this.singleClickTimeout);\n                }\n                if (evt.nativeEvent.changedTouches.length > 1) {\n                    var centerX = (evt.nativeEvent.changedTouches[0].pageX + evt.nativeEvent.changedTouches[1].pageX) / 2;\n                    _this.centerDiffX = centerX - _this.props.cropWidth / 2;\n                    var centerY = (evt.nativeEvent.changedTouches[0].pageY + evt.nativeEvent.changedTouches[1].pageY) / 2;\n                    _this.centerDiffY = centerY - _this.props.cropHeight / 2;\n                }\n                // 计算长按\n                if (_this.longPressTimeout) {\n                    clearTimeout(_this.longPressTimeout);\n                }\n                var _a = evt.nativeEvent, locationX = _a.locationX, locationY = _a.locationY, pageX = _a.pageX, pageY = _a.pageY;\n                _this.longPressTimeout = setTimeout(function () {\n                    _this.isLongPress = true;\n                    if (_this.props.onLongPress) {\n                        _this.props.onLongPress({ locationX: locationX, locationY: locationY, pageX: pageX, pageY: pageY });\n                    }\n                }, _this.props.longPressTime);\n                if (evt.nativeEvent.changedTouches.length <= 1) {\n                    // 一个手指的情况\n                    if (new Date().getTime() - _this.lastClickTime < (_this.props.doubleClickInterval || 0)) {\n                        // 认为触发了双击\n                        _this.lastClickTime = 0;\n                        // 因为可能触发放大，因此记录双击时的坐标位置\n                        _this.doubleClickX = evt.nativeEvent.changedTouches[0].pageX;\n                        _this.doubleClickY = evt.nativeEvent.changedTouches[0].pageY;\n                        if (_this.props.onDoubleClick) {\n                            _this.props.onDoubleClick({\n                                locationX: evt.nativeEvent.changedTouches[0].locationX,\n                                locationY: evt.nativeEvent.changedTouches[0].locationY,\n                                pageX: _this.doubleClickX,\n                                pageY: _this.doubleClickY,\n                            });\n                        }\n                        // 取消长按\n                        clearTimeout(_this.longPressTimeout);\n                        // 缩放\n                        _this.isDoubleClick = true;\n                        if (_this.props.enableDoubleClickZoom) {\n                            if (_this.scale > 1 || _this.scale < 1) {\n                                // 回归原位\n                                _this.scale = 1;\n                                _this.positionX = 0;\n                                _this.positionY = 0;\n                            }\n                            else {\n                                // 开始在位移地点缩放\n                                // 记录之前缩放比例\n                                // 此时 this.scale 一定为 1\n                                var beforeScale = _this.scale;\n                                // 开始缩放\n                                _this.scale = 2;\n                                // 缩放 diff\n                                var diffScale = _this.scale - beforeScale;\n                                // 找到两手中心点距离页面中心的位移\n                                // 移动位置\n                                _this.positionX = ((_this.props.cropWidth / 2 - _this.doubleClickX) * diffScale) / _this.scale;\n                                _this.positionY = ((_this.props.cropHeight / 2 - _this.doubleClickY) * diffScale) / _this.scale;\n                            }\n                            _this.imageDidMove('centerOn');\n                            react_native_1.Animated.parallel([\n                                react_native_1.Animated.timing(_this.animatedScale, {\n                                    toValue: _this.scale,\n                                    duration: 100,\n                                    useNativeDriver: !!_this.props.useNativeDriver,\n                                }),\n                                react_native_1.Animated.timing(_this.animatedPositionX, {\n                                    toValue: _this.positionX,\n                                    duration: 100,\n                                    useNativeDriver: !!_this.props.useNativeDriver,\n                                }),\n                                react_native_1.Animated.timing(_this.animatedPositionY, {\n                                    toValue: _this.positionY,\n                                    duration: 100,\n                                    useNativeDriver: !!_this.props.useNativeDriver,\n                                }),\n                            ]).start();\n                        }\n                    }\n                    else {\n                        _this.lastClickTime = new Date().getTime();\n                    }\n                }\n            },\n            onPanResponderMove: function (evt, gestureState) {\n                if (_this.isDoubleClick) {\n                    // 有时双击会被当做位移，这里屏蔽掉\n                    return;\n                }\n                if (evt.nativeEvent.changedTouches.length <= 1) {\n                    // x 位移\n                    var diffX = gestureState.dx - (_this.lastPositionX || 0);\n                    if (_this.lastPositionX === null) {\n                        diffX = 0;\n                    }\n                    // y 位移\n                    var diffY = gestureState.dy - (_this.lastPositionY || 0);\n                    if (_this.lastPositionY === null) {\n                        diffY = 0;\n                    }\n                    // 保留这一次位移作为下次的上一次位移\n                    _this.lastPositionX = gestureState.dx;\n                    _this.lastPositionY = gestureState.dy;\n                    _this.horizontalWholeCounter += diffX;\n                    _this.verticalWholeCounter += diffY;\n                    if (Math.abs(_this.horizontalWholeCounter) > 5 || Math.abs(_this.verticalWholeCounter) > 5) {\n                        // 如果位移超出手指范围，取消长按监听\n                        clearTimeout(_this.longPressTimeout);\n                    }\n                    if (_this.props.panToMove) {\n                        // 处理左右滑，如果正在 swipeDown，左右滑失效\n                        if (_this.swipeDownOffset === 0) {\n                            if (Math.abs(diffX) > Math.abs(diffY)) {\n                                _this.isHorizontalWrap = true;\n                            }\n                            // diffX > 0 表示手往右滑，图往左移动，反之同理\n                            // horizontalWholeOuterCounter > 0 表示溢出在左侧，反之在右侧，绝对值越大溢出越多\n                            if (_this.props.imageWidth * _this.scale > _this.props.cropWidth) {\n                                // 如果图片宽度大图盒子宽度， 可以横向拖拽\n                                // 没有溢出偏移量或者这次位移完全收回了偏移量才能拖拽\n                                if (_this.horizontalWholeOuterCounter > 0) {\n                                    // 溢出在右侧\n                                    if (diffX < 0) {\n                                        // 从右侧收紧\n                                        if (_this.horizontalWholeOuterCounter > Math.abs(diffX)) {\n                                            // 偏移量还没有用完\n                                            _this.horizontalWholeOuterCounter += diffX;\n                                            diffX = 0;\n                                        }\n                                        else {\n                                            // 溢出量置为0，偏移量减去剩余溢出量，并且可以被拖动\n                                            diffX += _this.horizontalWholeOuterCounter;\n                                            _this.horizontalWholeOuterCounter = 0;\n                                            if (_this.props.horizontalOuterRangeOffset) {\n                                                _this.props.horizontalOuterRangeOffset(0);\n                                            }\n                                        }\n                                    }\n                                    else {\n                                        // 向右侧扩增\n                                        _this.horizontalWholeOuterCounter += diffX;\n                                    }\n                                }\n                                else if (_this.horizontalWholeOuterCounter < 0) {\n                                    // 溢出在左侧\n                                    if (diffX > 0) {\n                                        // 从左侧收紧\n                                        if (Math.abs(_this.horizontalWholeOuterCounter) > diffX) {\n                                            // 偏移量还没有用完\n                                            _this.horizontalWholeOuterCounter += diffX;\n                                            diffX = 0;\n                                        }\n                                        else {\n                                            // 溢出量置为0，偏移量减去剩余溢出量，并且可以被拖动\n                                            diffX += _this.horizontalWholeOuterCounter;\n                                            _this.horizontalWholeOuterCounter = 0;\n                                            if (_this.props.horizontalOuterRangeOffset) {\n                                                _this.props.horizontalOuterRangeOffset(0);\n                                            }\n                                        }\n                                    }\n                                    else {\n                                        // 向左侧扩增\n                                        _this.horizontalWholeOuterCounter += diffX;\n                                    }\n                                }\n                                else {\n                                    // 溢出偏移量为0，正常移动\n                                }\n                                // 产生位移\n                                _this.positionX += diffX / _this.scale;\n                                // 但是横向不能出现黑边\n                                // 横向能容忍的绝对值\n                                var horizontalMax = (_this.props.imageWidth * _this.scale - _this.props.cropWidth) / 2 / _this.scale;\n                                if (_this.positionX < -horizontalMax) {\n                                    // 超越了左边临界点，还在继续向左移动\n                                    _this.positionX = -horizontalMax;\n                                    // 让其产生细微位移，偏离轨道\n                                    _this.horizontalWholeOuterCounter += -1 / 1e10;\n                                }\n                                else if (_this.positionX > horizontalMax) {\n                                    // 超越了右侧临界点，还在继续向右移动\n                                    _this.positionX = horizontalMax;\n                                    // 让其产生细微位移，偏离轨道\n                                    _this.horizontalWholeOuterCounter += 1 / 1e10;\n                                }\n                                _this.animatedPositionX.setValue(_this.positionX);\n                            }\n                            else {\n                                // 不能横向拖拽，全部算做溢出偏移量\n                                _this.horizontalWholeOuterCounter += diffX;\n                            }\n                            // 溢出量不会超过设定界限\n                            if (_this.horizontalWholeOuterCounter > (_this.props.maxOverflow || 0)) {\n                                _this.horizontalWholeOuterCounter = _this.props.maxOverflow || 0;\n                            }\n                            else if (_this.horizontalWholeOuterCounter < -(_this.props.maxOverflow || 0)) {\n                                _this.horizontalWholeOuterCounter = -(_this.props.maxOverflow || 0);\n                            }\n                            if (_this.horizontalWholeOuterCounter !== 0) {\n                                // 如果溢出偏移量不是0，执行溢出回调\n                                if (_this.props.horizontalOuterRangeOffset) {\n                                    _this.props.horizontalOuterRangeOffset(_this.horizontalWholeOuterCounter);\n                                }\n                            }\n                        }\n                        // 如果图片高度大于盒子高度， 可以纵向弹性拖拽\n                        if (_this.props.imageHeight * _this.scale > _this.props.cropHeight) {\n                            _this.positionY += diffY / _this.scale;\n                            _this.animatedPositionY.setValue(_this.positionY);\n                            // 如果图片上边缘脱离屏幕上边缘，则进入 swipeDown 动作\n                            // if (\n                            //   (this.props.imageHeight / 2 - this.positionY) * this.scale <\n                            //   this.props.cropHeight / 2\n                            // ) {\n                            //   if (this.props.enableSwipeDown) {\n                            //     this.swipeDownOffset += diffY\n                            //     // 只要滑动溢出量不小于 0，就可以拖动\n                            //     if (this.swipeDownOffset > 0) {\n                            //       this.positionY += diffY / this.scale\n                            //       this.animatedPositionY.setValue(this.positionY)\n                            //       // 越到下方，缩放越小\n                            //       this.scale = this.scale - diffY / 1000\n                            //       this.animatedScale.setValue(this.scale)\n                            //     }\n                            //   }\n                            // }\n                        }\n                        else {\n                            // swipeDown 不允许在已经有横向偏移量时触发\n                            if (_this.props.enableSwipeDown && !_this.isHorizontalWrap) {\n                                // 图片高度小于盒子高度，只能向下拖拽，而且一定是 swipeDown 动作\n                                _this.swipeDownOffset += diffY;\n                                // 只要滑动溢出量不小于 0，就可以拖动\n                                if (_this.swipeDownOffset > 0) {\n                                    _this.positionY += diffY / _this.scale;\n                                    _this.animatedPositionY.setValue(_this.positionY);\n                                    // 越到下方，缩放越小\n                                    _this.scale = _this.scale - diffY / 1000;\n                                    _this.animatedScale.setValue(_this.scale);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    // 多个手指的情况\n                    // 取消长按状态\n                    if (_this.longPressTimeout) {\n                        clearTimeout(_this.longPressTimeout);\n                    }\n                    if (_this.props.pinchToZoom) {\n                        // 找最小的 x 和最大的 x\n                        var minX = void 0;\n                        var maxX = void 0;\n                        if (evt.nativeEvent.changedTouches[0].locationX > evt.nativeEvent.changedTouches[1].locationX) {\n                            minX = evt.nativeEvent.changedTouches[1].pageX;\n                            maxX = evt.nativeEvent.changedTouches[0].pageX;\n                        }\n                        else {\n                            minX = evt.nativeEvent.changedTouches[0].pageX;\n                            maxX = evt.nativeEvent.changedTouches[1].pageX;\n                        }\n                        var minY = void 0;\n                        var maxY = void 0;\n                        if (evt.nativeEvent.changedTouches[0].locationY > evt.nativeEvent.changedTouches[1].locationY) {\n                            minY = evt.nativeEvent.changedTouches[1].pageY;\n                            maxY = evt.nativeEvent.changedTouches[0].pageY;\n                        }\n                        else {\n                            minY = evt.nativeEvent.changedTouches[0].pageY;\n                            maxY = evt.nativeEvent.changedTouches[1].pageY;\n                        }\n                        var widthDistance = maxX - minX;\n                        var heightDistance = maxY - minY;\n                        var diagonalDistance = Math.sqrt(widthDistance * widthDistance + heightDistance * heightDistance);\n                        _this.zoomCurrentDistance = Number(diagonalDistance.toFixed(1));\n                        if (_this.zoomLastDistance !== null) {\n                            var distanceDiff = (_this.zoomCurrentDistance - _this.zoomLastDistance) / 200;\n                            var zoom = _this.scale + distanceDiff;\n                            if (zoom < (_this.props.minScale || 0)) {\n                                zoom = _this.props.minScale || 0;\n                            }\n                            if (zoom > (_this.props.maxScale || 0)) {\n                                zoom = _this.props.maxScale || 0;\n                            }\n                            // 记录之前缩放比例\n                            var beforeScale = _this.scale;\n                            // 开始缩放\n                            _this.scale = zoom;\n                            _this.animatedScale.setValue(_this.scale);\n                            // 图片要慢慢往两个手指的中心点移动\n                            // 缩放 diff\n                            var diffScale = _this.scale - beforeScale;\n                            // 找到两手中心点距离页面中心的位移\n                            // 移动位置\n                            _this.positionX -= (_this.centerDiffX * diffScale) / _this.scale;\n                            _this.positionY -= (_this.centerDiffY * diffScale) / _this.scale;\n                            _this.animatedPositionX.setValue(_this.positionX);\n                            _this.animatedPositionY.setValue(_this.positionY);\n                        }\n                        _this.zoomLastDistance = _this.zoomCurrentDistance;\n                    }\n                }\n                _this.imageDidMove('onPanResponderMove');\n            },\n            onPanResponderRelease: function (evt, gestureState) {\n                // 取消长按\n                if (_this.longPressTimeout) {\n                    clearTimeout(_this.longPressTimeout);\n                }\n                // 双击结束，结束尾判断\n                if (_this.isDoubleClick) {\n                    return;\n                }\n                // 长按结束，结束尾判断\n                if (_this.isLongPress) {\n                    return;\n                }\n                // 如果是单个手指、距离上次按住大于预设秒、滑动距离小于预设值, 则可能是单击（如果后续双击间隔内没有开始手势）\n                // const stayTime = new Date().getTime() - this.lastTouchStartTime!\n                var moveDistance = Math.sqrt(gestureState.dx * gestureState.dx + gestureState.dy * gestureState.dy);\n                var _a = evt.nativeEvent, locationX = _a.locationX, locationY = _a.locationY, pageX = _a.pageX, pageY = _a.pageY;\n                if (evt.nativeEvent.changedTouches.length === 1 && moveDistance < (_this.props.clickDistance || 0)) {\n                    _this.singleClickTimeout = setTimeout(function () {\n                        if (_this.props.onClick) {\n                            _this.props.onClick({ locationX: locationX, locationY: locationY, pageX: pageX, pageY: pageY });\n                        }\n                    }, _this.props.doubleClickInterval);\n                }\n                else {\n                    // 多手势结束，或者滑动结束\n                    if (_this.props.responderRelease) {\n                        _this.props.responderRelease(gestureState.vx, _this.scale);\n                    }\n                    _this.panResponderReleaseResolve();\n                }\n            },\n            onPanResponderTerminate: function () {\n                //\n            },\n        });\n        _this.resetScale = function () {\n            _this.positionX = 0;\n            _this.positionY = 0;\n            _this.scale = 1;\n            _this.animatedScale.setValue(1);\n        };\n        _this.panResponderReleaseResolve = function () {\n            // 判断是否是 swipeDown\n            if (_this.props.enableSwipeDown && _this.props.swipeDownThreshold) {\n                if (_this.swipeDownOffset > _this.props.swipeDownThreshold) {\n                    if (_this.props.onSwipeDown) {\n                        _this.props.onSwipeDown();\n                    }\n                    // Stop reset.\n                    return;\n                }\n            }\n            if (_this.props.enableCenterFocus && _this.scale < 1) {\n                // 如果缩放小于1，强制重置为 1\n                _this.scale = 1;\n                react_native_1.Animated.timing(_this.animatedScale, {\n                    toValue: _this.scale,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            if (_this.props.imageWidth * _this.scale <= _this.props.cropWidth) {\n                // 如果图片宽度小于盒子宽度，横向位置重置\n                _this.positionX = 0;\n                react_native_1.Animated.timing(_this.animatedPositionX, {\n                    toValue: _this.positionX,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            if (_this.props.imageHeight * _this.scale <= _this.props.cropHeight) {\n                // 如果图片高度小于盒子高度，纵向位置重置\n                _this.positionY = 0;\n                react_native_1.Animated.timing(_this.animatedPositionY, {\n                    toValue: _this.positionY,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            // 横向肯定不会超出范围，由拖拽时控制\n            // 如果图片高度大于盒子高度，纵向不能出现黑边\n            if (_this.props.imageHeight * _this.scale > _this.props.cropHeight) {\n                // 纵向能容忍的绝对值\n                var verticalMax = (_this.props.imageHeight * _this.scale - _this.props.cropHeight) / 2 / _this.scale;\n                if (_this.positionY < -verticalMax) {\n                    _this.positionY = -verticalMax;\n                }\n                else if (_this.positionY > verticalMax) {\n                    _this.positionY = verticalMax;\n                }\n                react_native_1.Animated.timing(_this.animatedPositionY, {\n                    toValue: _this.positionY,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            if (_this.props.imageWidth * _this.scale > _this.props.cropWidth) {\n                // 纵向能容忍的绝对值\n                var horizontalMax = (_this.props.imageWidth * _this.scale - _this.props.cropWidth) / 2 / _this.scale;\n                if (_this.positionX < -horizontalMax) {\n                    _this.positionX = -horizontalMax;\n                }\n                else if (_this.positionX > horizontalMax) {\n                    _this.positionX = horizontalMax;\n                }\n                react_native_1.Animated.timing(_this.animatedPositionX, {\n                    toValue: _this.positionX,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            // 拖拽正常结束后,如果没有缩放,直接回到0,0点\n            if (_this.props.enableCenterFocus && _this.scale === 1) {\n                _this.positionX = 0;\n                _this.positionY = 0;\n                react_native_1.Animated.timing(_this.animatedPositionX, {\n                    toValue: _this.positionX,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n                react_native_1.Animated.timing(_this.animatedPositionY, {\n                    toValue: _this.positionY,\n                    duration: 100,\n                    useNativeDriver: !!_this.props.useNativeDriver,\n                }).start();\n            }\n            // 水平溢出量置空\n            _this.horizontalWholeOuterCounter = 0;\n            // swipeDown 溢出量置空\n            _this.swipeDownOffset = 0;\n            _this.imageDidMove('onPanResponderRelease');\n        };\n        return _this;\n    }\n    ImageViewer.prototype.componentDidMount = function () {\n        if (this.props.centerOn) {\n            this.centerOn(this.props.centerOn);\n        }\n    };\n    ImageViewer.prototype.componentDidUpdate = function (prevProps) {\n        // Either centerOn has never been called, or it is a repeat and we should ignore it\n        if ((this.props.centerOn && !prevProps.centerOn) ||\n            (this.props.centerOn && prevProps.centerOn && this.didCenterOnChange(prevProps.centerOn, this.props.centerOn))) {\n            this.centerOn(this.props.centerOn);\n        }\n    };\n    ImageViewer.prototype.imageDidMove = function (type) {\n        if (this.props.onMove) {\n            this.props.onMove({\n                type: type,\n                positionX: this.positionX,\n                positionY: this.positionY,\n                scale: this.scale,\n                zoomCurrentDistance: this.zoomCurrentDistance,\n            });\n        }\n    };\n    ImageViewer.prototype.didCenterOnChange = function (params, paramsNext) {\n        return params.x !== paramsNext.x || params.y !== paramsNext.y || params.scale !== paramsNext.scale;\n    };\n    ImageViewer.prototype.centerOn = function (params) {\n        var _this = this;\n        this.positionX = params.x;\n        this.positionY = params.y;\n        this.scale = params.scale;\n        var duration = params.duration || 300;\n        react_native_1.Animated.parallel([\n            react_native_1.Animated.timing(this.animatedScale, {\n                toValue: this.scale,\n                duration: duration,\n                useNativeDriver: !!this.props.useNativeDriver,\n            }),\n            react_native_1.Animated.timing(this.animatedPositionX, {\n                toValue: this.positionX,\n                duration: duration,\n                useNativeDriver: !!this.props.useNativeDriver,\n            }),\n            react_native_1.Animated.timing(this.animatedPositionY, {\n                toValue: this.positionY,\n                duration: duration,\n                useNativeDriver: !!this.props.useNativeDriver,\n            }),\n        ]).start(function () {\n            _this.imageDidMove('centerOn');\n        });\n    };\n    /**\n     * 图片区域视图渲染完毕\n     */\n    ImageViewer.prototype.handleLayout = function (event) {\n        if (this.props.layoutChange) {\n            this.props.layoutChange(event);\n        }\n    };\n    /**\n     * 重置大小和位置\n     */\n    ImageViewer.prototype.reset = function () {\n        this.scale = 1;\n        this.animatedScale.setValue(this.scale);\n        this.positionX = 0;\n        this.animatedPositionX.setValue(this.positionX);\n        this.positionY = 0;\n        this.animatedPositionY.setValue(this.positionY);\n    };\n    ImageViewer.prototype.render = function () {\n        var animateConf = {\n            transform: [\n                {\n                    scale: this.animatedScale,\n                },\n                {\n                    translateX: this.animatedPositionX,\n                },\n                {\n                    translateY: this.animatedPositionY,\n                },\n            ],\n        };\n        var parentStyles = react_native_1.StyleSheet.flatten(this.props.style);\n        return (<react_native_1.View style={__assign(__assign(__assign({}, image_zoom_style_1.default.container), parentStyles), { width: this.props.cropWidth, height: this.props.cropHeight })} {...this.imagePanResponder.panHandlers}>\n        <react_native_1.Animated.View style={animateConf} renderToHardwareTextureAndroid={this.props.useHardwareTextureAndroid}>\n          <react_native_1.View onLayout={this.handleLayout.bind(this)} style={{\n            width: this.props.imageWidth,\n            height: this.props.imageHeight,\n        }}>\n            {this.props.children}\n          </react_native_1.View>\n        </react_native_1.Animated.View>\n      </react_native_1.View>);\n    };\n    ImageViewer.defaultProps = new image_zoom_type_1.ImageZoomProps();\n    return ImageViewer;\n}(React.Component));\nexports.default = ImageViewer;\n//# sourceMappingURL=image-zoom.component.js.map"]},"metadata":{},"sourceType":"script"}